"use strict";(self.webpackChunkadmin_material=self.webpackChunkadmin_material||[]).push([[721],{16925:(e,t,a)=>{a.d(t,{v:()=>c});var s=a(38820),n=a(52524),i=a(5397),l=a(20068),r=a(13400),o=a(37725),d=a(80184);const c=(e,t,a)=>[{field:"name",headerName:"Name",width:230,renderCell:e=>(0,d.jsxs)("div",{className:"cellWithImg",children:[(0,d.jsx)("img",{src:e.row.pic?"".concat(o.y,"/public/customers/images/").concat(e.row.pic):"./img/avatarfile.png",alt:"",className:"cellImg"}),e.row.name.length>30?e.row.name.substring(0,30)+"....":e.row.name]})},{field:"balance",headerName:"Receivable",width:150,renderCell:e=>{var t;return(0,d.jsx)("div",{className:"cellWithStatus ".concat(e.row.status),children:(null===(t=e.row.balance)||void 0===t?void 0:t.toLocaleString("en-US",{style:"currency",currency:"PKR",minimumFractionDigits:2,maximumFractionDigits:2}))||0})}},{field:"contact",headerName:"Contact",width:150},{field:"address",headerName:"Address",width:200},{field:"status",headerName:"Status",width:100,renderCell:e=>(0,d.jsx)("div",{style:{background:"active"===e.row.status.toLowerCase()?"#02bf2e":"#999",color:"white",width:65,textAlign:"center",borderRadius:4},children:e.row.status})},{field:"action",headerName:"Action",width:160,renderCell:o=>(0,d.jsxs)("div",{className:"cellAction",children:[(0,d.jsx)(l.Z,{title:"Edit Customer",children:(0,d.jsx)(r.Z,{className:"viewButton",onClick:()=>{a(!0)},children:(0,d.jsx)(s.Z,{style:{fontSize:"20px"}})})}),(0,d.jsx)(l.Z,{title:"View Detials",children:(0,d.jsx)(r.Z,{className:"viewButton",onClick:()=>t(!0),children:(0,d.jsx)(n.Z,{style:{fontSize:"20px"}})})}),(0,d.jsx)(l.Z,{title:"Delete Customer",children:(0,d.jsx)(r.Z,{className:"viewButton",onClick:()=>e(!0),children:(0,d.jsx)(i.Z,{style:{fontSize:"20px"}})})})]})}]},96418:(e,t,a)=>{a.d(t,{Lg:()=>i,PV:()=>s,Vx:()=>n});const s=(e,t)=>[{id:1,label:"Name",type:"text",name:"name",tabIndex:0,grid:{xs:12,sm:6,md:6,lg:6}},{id:2,label:"Email",tabIndex:1,type:"email",name:"email",grid:{xs:12,sm:6,md:6,lg:6}},{id:3,label:"Contact",tabIndex:2,type:"phone",name:"contact",grid:{xs:12,sm:6,md:6,lg:6}},{id:4,label:"Balance",tabIndex:3,type:"number",name:"balance",grid:{xs:12,sm:6,md:6,lg:6}},{id:5,label:"Address",tabIndex:4,type:"text",name:"address",grid:{xs:12,sm:6,md:6,lg:6}},{id:6,label:"Status",type:"select",tabIndex:5,disable:!1,name:"status",size:"small",minWidth:"100wh",grid:{xs:12,sm:6,md:6,lg:6},options:[{id:1,name:"Active",value:"active"},{id:2,name:"Deactive",value:"deactive"}]},{id:7,label:null!==e&&0!==Object.keys(t).length?"Update Customer":"ADD CUSTOMER",type:"button",tabIndex:6,btntype:"submit",color:"primary",variant:"contained",grid:{xs:12,sm:12,md:12,lg:12}}],n=e=>[{id:1,label:"Condition",type:"select",disable:"inBetween"===e.operator,name:"operator",size:"small",minWidth:"100wh",grid:{xs:12,sm:6,md:4,lg:4},options:["date"!==e.field&&{id:1,name:"Contains",value:"$regex"},"date"!==e.field&&{id:2,name:"Equals",value:"$eq"},"date"===e.field&&{id:7,name:"In Between",value:"inBetween"}]},{id:2,label:"Select Column",type:"select",name:"field",size:"small",minWidth:"100wh",grid:{xs:12,sm:6,md:4,lg:4},options:[{id:1,name:"Name",value:"name"},{id:2,name:"Email",value:"email"},{id:3,name:"Contact",value:"contact"},{id:4,name:"Status",value:"status"}]},{id:3,label:"Sorting",type:"select",name:"sort",size:"small",options:[{id:1,name:"Ascending",value:1},{id:2,name:"Descending",value:-1}],grid:{xs:12,sm:6,md:4,lg:4}}],i=e=>["date"!==e.field&&"contact"!==e.field&&{id:1,label:"Enter ".concat(null===e||void 0===e?void 0:e.field.replace(/^_/,"").replace(/([A-Z])/g," $1").replace(/^./,(function(e){return e.toUpperCase()}))),type:"text",disabled:""===e.field,name:"searchInput",grid:{xs:12,sm:10}},"date"===e.field&&"inBetween"===e.operator&&{id:2,label:"Start Date",type:"date",name:"startDate",grid:{xs:12,sm:"inBetween"===e.operator?5:10}},"date"===e.field&&"inBetween"===e.operator&&{id:3,label:"End Date",type:"date",name:"endDate",grid:{xs:12,sm:5}},"contact"===e.field&&{id:4,type:"phone",name:"searchInput",grid:{xs:12,sm:8,md:8,lg:10}},{id:5,label:"Search",type:"button",btntype:"submit",variant:"contained",color:"primary",grid:{xs:12,sm:2}}]},65466:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});a(22317);var s=a(697),n=a(72791),i=a(59434),l=a(75985),r=a(28924),o=a(66351),d=a(19570),c=a(98635),m=a(26384),p=a(97246),u=a(66807),h=a(92167),g=a(5092),x=a(16925),f=a(96418),b=a(70591),v=a(71099),y=a(39086),w=a(37725),D=a(80184);const j=()=>{const e=(0,i.I0)(),{user:t}=(0,n.useContext)(y.Z),a=(0,i.v9)((e=>e.customers.data)),j=(0,i.v9)((e=>e.customers.current)),C=(0,i.v9)((e=>e.customers.totalRecord)),S=(0,i.v9)((e=>e.customers.errors)),[Z,E]=(0,n.useState)(!1),[A,I]=(0,n.useState)(!1),[O,N]=(0,n.useState)(!1),[R,z]=(0,n.useState)(null),[B,F]=(0,n.useState)(0),[L,M]=(0,n.useState)(""),[P,k]=(0,n.useState)({userId:t._id,name:"",email:"",contact:"",address:"",balance:"",status:"",pic:""}),[V,T]=(0,n.useState)({field:"",operator:"",sort:-1}),[U,W]=(0,n.useState)({searchInput:""}),[_,$]=(0,n.useState)(!1),[H,q]=(0,n.useState)(window.matchMedia("(max-width: 768px)").matches);(0,n.useEffect)((()=>{const e=window.matchMedia("(max-width: 768px)"),t=()=>q(e.matches);return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}),[]),(0,n.useEffect)((()=>{const t={page:0,sort:V.sort};return e((0,v.OL)(t)),()=>{e((0,v.HO)())}}),[e,V.sort]),(0,n.useEffect)((()=>{R&&(Z||A)&&e((0,v.gV)(R))}),[R,Z,A,e]),(0,n.useEffect)((()=>{if(0!==Object.keys(j).length&&(k({name:j.name,email:j.email,contact:j.contact,balance:j.balance,address:j.address,status:j.status}),j.pic)){(async e=>{const t=await fetch(e),a=await t.blob();return new File([a],"profile.jpg",{type:"image/jpeg"})})("".concat(w.y,"/public/customers/images/").concat(j.pic)).then(M)}}),[j]),(0,n.useEffect)((()=>{"date"===V.field&&"inBetween"!==V.operator?T({...V,operator:"inBetween"}):"date"!==V.field&&"inBetween"===V.operator&&T({...V,operator:"$regex"})}),[V.field]),(0,n.useEffect)((()=>{(null===S||void 0===S?void 0:S.length)>0?S.forEach((e=>{(0,l.Am)(e.msg,{position:"top-right",type:"error"})})):G()}),[S]);const G=()=>{E(!1),z(null),k({userId:t._id,name:"",email:"",contact:"",address:"",balance:"",status:""}),M("")},K=e=>e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),J=async t=>{e(R?(0,v.uG)({id:R[0],Data:t}):(0,v.Sy)(t))},Q=a.map((e=>({...e,name:e.name&&K(e.name),address:e.address&&K(e.address),status:e.status&&K(e.status)})));return(0,D.jsxs)(s.Z,{m:"0px 20px 15px 20px",children:[(0,D.jsx)(r.Z,{icon:(0,D.jsx)(h.Z,{style:{marginRight:"10px"}}),title:"Customers",subTitle:"Manage Application Customers",addBtnTitle:H?"Add":"Add Customer",dialog:Z,setDialog:E}),(0,D.jsxs)(s.Z,{className:"mainCard",children:[(0,D.jsx)(c.Z,{openFormDialog:Z,setOpenFormDialog:E,heading:R?"UPDATE CUSTOMER":"ADD CUSTOMER",color:"#999999",state:P,setState:k,file:L,setFile:M,handleOnClose:G,handleOnSubmit:async e=>{e.preventDefault();const{name:t,balance:a,status:s}=P;if(t)if(a)if(s)if(L)try{const e=new FormData;e.append("file",L);const t=await(0,b.p)(e);if(null!==t&&void 0!==t&&t.success){const e={...P,pic:t.filename};await J(e)}}catch(n){(0,l.Am)("Error uploading image",{position:"top-right",type:"error"})}else await J(P);else(0,l.Am)("Please select status",{position:"top-right",type:"error"});else(0,l.Am)("Enter initial balance",{position:"top-right",type:"error"});else(0,l.Am)("Enter Customer name",{position:"top-right",type:"error"})},inputs:(0,f.PV)(R,j),icon:(0,D.jsx)(h.Z,{style:{marginRight:"10px"}})}),0!==Object.keys(j).length&&(0,D.jsx)(m.Z,{openDetailsDialog:A,heading:"".concat(K(j.name),"'s Detail"),inputs:j,handleOnCloseDetails:()=>{I(!1),z(null),k({name:"",email:"",contact:"",address:"",balance:"",status:""}),M("")},icon:(0,D.jsx)(g.Z,{style:{marginRight:"10px"}})}),(0,D.jsx)(d.Z,{openDeleteDialog:O,setOpenDeleteDialog:N,handleOnDelete:()=>{e((0,v.LA)(R)),z(null)},heading:"DELETE CUSTOMER",color:"#ff0000",icon:(0,D.jsx)(u.Z,{style:{marginRight:"10px"}}),message:"Are you sure you want to delete this customer? This action cannot be undone."}),(0,D.jsx)(p.Z,{submit:async t=>{t.preventDefault();const{startDate:a,endDate:s,searchInput:n}=U,{field:i,operator:r,sort:o}=V,d={field:i||void 0,operator:r,sort:o,page:0,searchInput:n,startDate:s&&!a?s:a,endDate:s||a};"date"!==i||a||s?!i||n?!i||r?(e((0,v.OL)(d)),$(!1),F(0)):(0,l.Am)("Please select condition",{position:"top-right",type:"error"}):(0,l.Am)("Please Enter to search..",{position:"top-right",type:"error"}):(0,l.Am)("Please Select Date",{position:"top-right",type:"error"})},filters:V,setFilter:T,state:U,setState:W,openFiltersPanel:_,setOpenFiltersPanel:$,loadDataFunc:()=>{e((0,v.OL)({page:0,sort:-1}))},searchFiltersForm:f.Vx,searchInputForm:f.Lg}),(0,D.jsx)(o.Z,{columns:(0,x.v)(N,I,E),rows:Q,currentPage:B,totalRecords:C,selectedRowId:R,setSelectedRowId:z,handleOnPageChange:t=>{const{startDate:a,endDate:s,searchInput:n}=U,{field:i,operator:l,sort:r}=V,o={field:i||void 0,operator:l,sort:r,page:t,searchInput:n,startDate:s&&!a?s:a,endDate:s||a};e((0,v.OL)(o)),F(t)}})]})]})}},70591:(e,t,a)=>{a.d(t,{p:()=>l});var s=a(74569),n=a.n(s),i=a(37725);const l=async e=>{try{return await n().post("".concat(i.y,"/api/uploads"),e).then((e=>e.data))}catch(t){return t.response.data}}},5397:(e,t,a)=>{a.d(t,{Z:()=>i});var s=a(74223),n=a(80184);const i=(0,s.Z)((0,n.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete")},38820:(e,t,a)=>{a.d(t,{Z:()=>i});var s=a(74223),n=a(80184);const i=(0,s.Z)((0,n.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit")},52524:(e,t,a)=>{a.d(t,{Z:()=>i});var s=a(74223),n=a(80184);const i=(0,s.Z)((0,n.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}),"Info")},22317:()=>{}}]);
//# sourceMappingURL=721.0c58b163.chunk.js.map