"use strict";(self.webpackChunkadmin_material=self.webpackChunkadmin_material||[]).push([[885],{51984:(e,t,s)=>{s.r(t),s.d(t,{default:()=>P});var a=s(697),i=s(72791),r=s(28924),n=s(66351),o=s(59434),l=s(19570),c=s(66807),d=s(74223),h=s(80184);const p=(0,d.Z)((0,h.jsx)("path",{d:"M17 12c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm1.65 7.35L16.5 17.2V14h1v2.79l1.85 1.85-.7.71zM18 3h-3.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H6c-1.1 0-2 .9-2 2v15c0 1.1.9 2 2 2h6.11c-.59-.57-1.07-1.25-1.42-2H6V5h2v3h8V5h2v5.08c.71.1 1.38.31 2 .6V5c0-1.1-.9-2-2-2zm-6 2c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"}),"PendingActions");var u=s(82703),g=s(97246),m=s(75985),v=(s(92686),s(21701)),f=(s(79421),s(17568)),x=s(99262),w=s(11436);const D=(0,d.Z)((0,h.jsx)("path",{d:"M21 21.78 4.22 5 3 6.22l2.04 2.04C4.42 8.6 4 9.25 4 10v10c0 1.1.9 2 2 2h12c.23 0 .45-.05.66-.12L19.78 23 21 21.78zM8.9 6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2H9.66L20 18.34V10c0-1.1-.9-2-2-2h-1V6c0-2.76-2.24-5-5-5-2.56 0-4.64 1.93-4.94 4.4L8.9 7.24V6z"}),"NoEncryption"),j=(0,d.Z)((0,h.jsx)("path",{d:"M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"}),"Print");var y=s(5397),S=s(20068),C=s(13400),Z=s(37725),R=s(87749);const z=(e,t,s,a)=>[{field:"name",headerName:"Cashier Name",width:250,renderCell:e=>{var t;return(0,h.jsxs)("div",{className:"cellWithImg",children:[(0,h.jsx)("img",{src:null!==(t=e.row.cashier)&&void 0!==t&&t.pic?"".concat(Z.y,"/public/users/images/").concat(e.row.cashier.pic):"./img/avatarfile.png",alt:"",className:"cellImg"}),e.row.cashier.name.length>11?e.row.cashier.name.substring(0,11)+"....":e.row.cashier.name]})}},{field:"date",headerName:"Date",width:250},{field:"status",headerName:"Status",width:250,renderCell:e=>(0,h.jsxs)("div",{style:{background:"open"===e.row.status?"#02bf2e":"#999",color:"white",width:75,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:4},children:["open"===e.row.status?(0,h.jsx)(D,{style:{height:15,width:15,marginRight:5}}):(0,h.jsx)(R.Z,{style:{height:15,width:15,marginRight:5}})," ",e.row.status]})},{field:"action",headerName:"Action",width:200,renderCell:t=>(0,h.jsxs)("div",{className:"cellAction",children:[(0,h.jsx)(S.Z,{title:"Print Report",children:(0,h.jsx)(C.Z,{className:"viewButton",onClick:()=>s(t.row._id),children:(0,h.jsx)(j,{style:{fontSize:"20px"}})})}),"open"===t.row.status&&"web_admin"===a.access&&(0,h.jsx)(S.Z,{title:"Delete Closing",children:(0,h.jsx)(C.Z,{className:"viewButton",onClick:()=>e(!0),children:(0,h.jsx)(y.Z,{style:{fontSize:"20px"}})})})]})}];var A=s(11426),E=s(39086);const P=()=>{const e=(0,o.I0)(),{user:t}=(0,i.useContext)(E.Z),s=(0,o.v9)((e=>e.closings.data)),d=(0,o.v9)((e=>e.sales.current)),D=(0,o.v9)((e=>e.closings.totalRecord)),j=(0,o.v9)((e=>e.sales.errors)),[y,S]=(0,i.useState)(!1),[C,Z]=(0,i.useState)(!1),[R,P]=(0,i.useState)(!1),[b,k]=(0,i.useState)(null),[I,N]=(0,i.useState)(0),[V,O]=(0,i.useState)({field:"",operator:"",sort:-1}),[H,L]=(0,i.useState)({searchInput:"",startDate:"",endDate:""}),[M,F]=(0,i.useState)({name:"",type:"",initialReading:"",currentReading:"",status:""}),[X,B]=(0,i.useState)(!1);(0,i.useEffect)((()=>{(void 0!==b&&!0===y||void 0!==b&&!0===C)&&e((0,f.OD)(b[0]))}),[b]),console.log("Checking the search State ",H),(0,i.useEffect)((()=>{0!==Object.keys(d).length&&F({name:d.name,type:d.type,initialReading:d.initialReading,currentReading:d.currentReading,status:d.status})}),[d]),(0,i.useEffect)((()=>{const t={page:0,sort:V.sort};return e((0,A.ew)(t)),()=>{e((0,A.Lp)())}}),[]),(0,i.useEffect)((()=>{"date"===V.field?O({...V,operator:"inBetween"}):"inBetween"===V.operator&&O({...V,operator:"$regex"})}),[V.field]),(0,i.useEffect)((()=>{(null===j||void 0===j?void 0:j.length)>0&&j.forEach((e=>{(0,m.Am)(e.msg,{position:"top-right",type:"error"})}))}),[j]);function _(e){let t=0,s=0;return null===e||void 0===e||e.forEach((e=>{t+=e.quantity*e.price.newSellingPrice,s+=e.price.newSellingPrice/100*e.discount*e.quantity})),{totalAmount:t,totalDiscount:s}}const q=s.length>0?s.map((e=>({...e,totalAmount:e.items&&_(e.items).totalAmount,totalDiscount:e.items&&_(e.items).totalDiscount,product:e.items}))):[];return(0,h.jsxs)(a.Z,{m:"0px 20px 15px 20px",children:[(0,h.jsx)(r.Z,{icon:(0,h.jsx)(p,{style:{marginRight:"10px"}}),title:"Shift Closings",subTitle:"Manage Application Sale Closings"}),(0,h.jsxs)(a.Z,{className:"mainCard",children:[(0,h.jsx)(x.Z,{openDetailsDialog:C,heading:0!==Object.keys(d).length?"Sales Detail of ".concat(d.customer.name):"Sale Details",inputs:0!==Object.keys(d).length&&d,icon:(0,h.jsx)(u.Z,{style:{marginRight:"10px"}}),handleOnCloseDetails:()=>{Z(!1)}}),(0,h.jsx)(l.Z,{openDeleteDialog:R,setOpenDeleteDialog:P,handleOnDelete:()=>{e((0,A.tM)(b)),k(null)},heading:"DELETE SALE",color:"#ff0000",icon:(0,h.jsx)(c.Z,{style:{marginRight:"10px"}}),message:"Are sure you want to delete Sale?."}),(0,h.jsx)(g.Z,{submit:async t=>{t.preventDefault();const{startDate:s,endDate:a,searchInput:i}=H,{field:r,operator:n,sort:o}=V;let l={field:""===r?void 0:r,operator:n,sort:o,page:0,searchInput:i,startDate:""!==a&&""===s?a:s,endDate:""===a&&""!==s?s:a};"date"===r?""===s&&""===a?(0,m.Am)("Please Select Date",{position:"top-right",type:"error"}):(e((0,f.X8)(l)),B(!X),N(0)):""===r?(e((0,f.X8)(l)),B(!X),N(0)):""!==r&&""===i?(0,m.Am)("Please Enter to search..",{position:"top-right",type:"error"}):""!==r&&""!==i&&""===n?(0,m.Am)("Please select condition",{position:"top-right",type:"error"}):(e((0,f.X8)(l)),B(!X),N(0))},filters:V,setFilter:O,state:H,setState:L,openFiltersPanel:X,setOpenFiltersPanel:B,loadDataFunc:()=>{e((0,f.X8)({page:0,sort:-1}))},searchFiltersForm:w.s,searchInputForm:v.eK}),(0,h.jsx)(n.Z,{columns:z(P,0,(t=>{e((0,A.hC)(t)),console.log("Check print id => ",t)}),t),rows:q,currentPage:I,totalRecords:D,selectedRowId:b,setSelectedRowId:k,handleOnPageChange:t=>{N(t);const{startDate:s,endDate:a,searchInput:i}=H,{field:r,operator:n,sort:o}=V;let l={field:""===r?"":r,operator:n,sort:o,page:t,searchInput:i,startDate:""!==a&&""===s?a:s,endDate:""===a&&""!==s?s:a};"date"===r?""===s&&""===a?(0,m.Am)("Please Select Date",{position:"top-right",type:"error"}):e((0,f.X8)(l)):""===r?e((0,f.X8)(l)):""!==r&&""===i?(0,m.Am)("Please Enter to search..",{position:"top-right",type:"error"}):e((0,f.X8)(l))}})]})]})}},87749:(e,t,s)=>{var a=s(64836);t.Z=void 0;var i=a(s(45649)),r=s(80184),n=(0,i.default)((0,r.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"}),"Lock");t.Z=n}}]);
//# sourceMappingURL=885.7aeabd7a.chunk.js.map